package DLL;

import java.util.*;

class Node{
	int id ;
	String song ;
	String artist;
	
	Node prev , next;
	
	Node(int id , String song , String artist){
		this.id = id ;
		this.song = song;
		this.artist = artist;
		this.prev = null;
		this.next = null;
	}
}

class Playlist{
	Node head , tail , current;
	
	Playlist(){
		head = tail = current =  null;
	}
	
	
	public void insertfirst(int id , String song , String artist) {
		Node newnode = new Node(id , song , artist);
		
		if(head == null) {
			head = tail = current = newnode;
			return;
		}
		
		else {
			newnode.next = head;
			head.prev = newnode ;
			head = newnode;
		}
		System.out.println("New song added at the beginning!");
	}

	
	public void insertlast(int id , String song , String artist) {
		Node newsong = new Node(id , song , artist);
		
		if (tail == null) {
			head = tail = current = newsong;
		}
		else {
			tail.next = newsong ;
			newsong.prev = tail;
			tail = newsong;
		}
		
		System.out.println("Song inserted at last successfulluy");
	}
	
	public void insertat(int id , String name , String artist, int pos) {
		Node newSong = new Node(id , name , artist);
		
		if(pos < 0 ) {
			System.out.println("Invalid position!!(NEGATIVE????)");
			return;
		}
		
		if(head == null) {
			if(pos > 0 ) {
				System.out.println("invalid position man");
				return;
			}
			else {
				head = tail = current = newSong;
				newSong.prev = null;
				newSong.next = null;
				 System.out.println("New song inserted at postion specified");
			}
		}
			
		if(pos == 0) {
			insertfirst(id , name , artist);
		}
			
			
		Node ptr = head;
		for(int i = 0 ; i < pos -1; i++) {
			ptr = ptr.next;
			if(ptr == null) {
				System.out.println("Invalid");
			return;
			}
		}
				
			if(ptr.next == null) {
				insertlast(id , name , artist);
				return;
			}
				
			newSong.next = ptr.next;
			newSong.prev = ptr;
			ptr.next.prev = newSong;
			ptr.next = newSong;
				
			System.out.println("New song added successfully at the position : " + pos);
	}
	
	public void displayforward() {
		if(head == null) {
			System.out.println("Playlist is emptyyyyy");
			return;
		}
		
		System.out.println("======Playlist(forward)");
		Node temp = head;
		while(temp !=null) {
			System.out.println("Song ID: " +temp.id+  "| Song name: "+ temp.song+ " | Song artist: "+ temp.artist );
			temp = temp.next;
		}
	}
	
	public void displayreverse() {
		if(tail == null) {
			System.out.println("Playlist is emptyyyyy");
			return;
		}
		
		System.out.println("======Playlist(reverse)");
		Node temp = tail;
		while(temp !=null) {
			System.out.println("Song ID: " +temp.id+  "| Song name: "+ temp.song+ " | Song artist: "+ temp.artist );
			temp = temp.prev;
		}
	}
	
	
	public void playnext() {
		if(current == null) {
			System.out.println("Nothing to play next");
		} else if(current.next!= null) {
			current = current.next;
			showcurrent();
		}
		else {
			System.out.println("You are at the last song!!");
		}
	}
	
	public void playprevious() {
		if(current == null) {
			System.out.println("Nothing to play next");
		} else if(current.next!= null) {
			current = current.next;
			showcurrent();
		}
		else {
			System.out.println("You are at the last song!!");
		}
	}
	
	public void showcurrent() {
		if(current == null) {
			System.out.println("No song in playlist");
		}
		System.out.println(" Now Playing -> ID:" + current.id+  " Song: "+ current.song +" Artist: " +current.artist );
	}
	
	public void deletesong(int id) {
		if(head == null) {
			System.out.println("No song in playlist");
		}
		
		Node temp = head;
		while(temp!= null && temp.id == id) {
			temp = temp.next;
		}
		
		if(temp == null) {
			System.out.println("Id not found!");
			return;
		}
		
		if(temp == head ) {
			head = head.next;
			if(head != null) 
				head.prev = null;
		} else if(temp == tail) {
				tail = tail.prev;
				if(tail != null)
					tail.next= null;
			}
		else
			temp.next.prev = temp.prev;
			temp.prev.next = temp.next;
			
			if(current == temp) {
				if(temp.next!= null) {
					current = temp.next;
				}
				else
					current = temp.prev;
			}
			System.out.println("Song deleted successfully!!");
			
	}
}



public class DLL {

	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
        Playlist playlist = new Playlist();
        int choice;

        System.out.println("ðŸŽ¶ Welcome to Spotify Simulation ðŸŽ¶");

        do {
            System.out.println("\n--- Music Player Menu ---");
            System.out.println("1. Insert Song at Beginning");
            System.out.println("2. Insert Song at Position");
            System.out.println("3. Insert Song at End");
            System.out.println("4. Play Next Song");
            System.out.println("5. Play Previous Song");
            System.out.println("6. Show Current Song");
            System.out.println("7. Delete Song by ID");
            System.out.println("8. Show Playlist (Forward)");
            System.out.println("9. Show Playlist (Reverse)");
            System.out.println("10. Exit");
            System.out.print("Enter your choice: ");
            choice = sc.nextInt();
            sc.nextLine();

            switch (choice) {
                case 1 -> {
                    System.out.print("Enter Song ID: ");
                    int id = sc.nextInt();
                    sc.nextLine();
                    System.out.print("Enter Song Name: ");
                    String name = sc.nextLine();
                    System.out.print("Enter Artist Name: ");
                    String artist = sc.nextLine();
                    playlist.insertFirst(id, name, artist);
                }
                case 2 -> {
                    System.out.print("Enter Song ID: ");
                    int id = sc.nextInt();
                    sc.nextLine();
                    System.out.print("Enter Song Name: ");
                    String name = sc.nextLine();
                    System.out.print("Enter Artist Name: ");
                    String artist = sc.nextLine();
                    System.out.print("Enter position to insert: ");
                    int pos = sc.nextInt();
                    sc.nextLine();
                    playlist.insertAtPosition(id, name, artist, pos);
                }
                case 3 -> {
                    System.out.print("Enter Song ID: ");
                    int id = sc.nextInt();
                    sc.nextLine();
                    System.out.print("Enter Song Name: ");
                    String name = sc.nextLine();
                    System.out.print("Enter Artist Name: ");
                    String artist = sc.nextLine();
                    playlist.insertLast(id, name, artist);
                }
                case 4 -> playlist.playNext();
                case 5 -> playlist.playPrevious();
                case 6 -> playlist.showCurrent();
                case 7 -> {
                    System.out.print("Enter Song ID to delete: ");
                    int delId = sc.nextInt();
                    sc.nextLine();
                    playlist.deleteSong(delId);
                }
                case 8 -> playlist.displayForward();
                case 9 -> playlist.displayReverse();
                case 10 -> System.out.println("Exiting... Thanks for using Spotify Simulation!");
                default -> System.out.println("Invalid choice, try again!");
            }
        } while (choice != 10);

        sc.close();
	}

}
